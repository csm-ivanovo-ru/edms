# Change log

## Unreleased changes

## 2.19.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлено получение свойства "Должность" (для получения должности работника
      в должностной инструкции):
      `ИТГ_УправлениеСвойствами.ПолучитьЗначениеСвойства_ДолжностьРаботника`

## 2.18.0

Исправлены ошибки:

- в расширении ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

  - в обработчике `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`,
    проверяем заголовок во входящем письме
    [`X-Auto-Response-Suppress`](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxcmail/ced68690-498a-4567-9d14-5c01f974d8b1)
    и при наличии `RN` или `AutoReply` не генерируем автоответ.

  - ошибка при возврате списка автоподстановок из ошибки при использовании в `НСтр`
    вызова `ОбщегоНазначенияКлиентСервер.КодОсновногоЯзыка()`

## 2.17.1

Исправлены ошибки:

- в расширении ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

  - в `НСтр` использован вызов `ОбщегоНазначенияКлиентСервер.КодОсновногоЯзыка()`

## 2.17.0

Усовершенствования:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - в обработчике бизнес-события регистрации входящего документа,
      созданного на основании входящего письма,
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`,
      в автоматическом ответе добавлены заголовки:
      - [`Auto-Submitted`](https://tools.ietf.org/html/rfc4021#section-2.1.60):
        `Auto-Submitted: auto-replied`
        https://www.iana.org/assignments/auto-submitted-keywords/auto-submitted-keywords.xhtml
        https://tools.ietf.org/html/rfc3834#section-5
      - `X-1C-AutoReply: true`. Это важно, если и с другой стороны 1С:ДО.
      - [`X-Auto-Response-Suppress`](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxcmail/ced68690-498a-4567-9d14-5c01f974d8b1):
        `X-Auto-Response-Suppress: DR, NDR, RN, NRN, OOF`

## 2.16.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлен обработчик бизнес-события изменения документа:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеУстановитьПометкуУдаленияДокументаИПрерватьПроцессы`.
      При установке пометки на удаление на документе прерывает все процессы,
      в которых он был единственным основным предметом.

## 2.15.0

Усовершенствования:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - унифицирован механизм специализации ролей реквизитами документа.
      Использование объектов адресации (в частности - `Организация` и
      `Подразделение`) определяется настройками самой роли.
      Для этих целей добавлена функция
      `Справочники.ПолныеРоли.НайтиСоздатьПолнуюРольПоОбъектамАдресации`.

## 2.14.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлено условие маршрутизации "Зарегистрирован не регистратором
      переписки отправителя".

## 2.13.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлена автоподстановка "Регистратор переписки отправителя".
      Возвращает полную роль "Регистратор переписки", вычисленную по подразделению,
      осуществляющему делопроизводство по исходящему документу.

## 2.12.1

Добавлена документация:

- добавлен файл [`CODEOWNERS`](https://help.github.com/en/github/creating-cloning-and-archiving-repositories/about-code-owners)

## 2.12.0

Исправлены ошибки:

- в конфигурации

  - через расширение ДокументооборотКОРП_ИсправлениеАвтозаполненияOpenOffice:

    - устранено появление лишних пробелов при автоматическом заполнении
      файлов Open Office данными документа
      (https://github.com/test-st-petersburg/edms/issues/23)

## 2.11.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлена автоподстановка "Персонал метрологических подразделений"

## 2.10.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлена автоподстановка "Руководители метрологических подразделений"

Изменения:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - роль "Руководитель подразделения"
      больше не требует использования в качестве объекта адресации организации
      (даже если включена функциональная опция "Использовать учёт по организациям"),
      только подразделение

    - роль "Делопроизводитель подразделения"
      больше не требует использования в качестве объекта адресации организации
      (даже если включена функциональная опция "Использовать учёт по организациям"),
      только подразделение

    - роль "Регистратор переписки"
      больше не требует использования в качестве объекта адресации организации
      (даже если включена функциональная опция "Использовать учёт по организациям"),
      только подразделение

## 2.9.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлен обработчик бизнес-события изменения документа:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеУстановитьПометкуУдаленияДокумента`.
      Добавляет к наименованию документа "(удалён)" при установке пометки на удаление.
      И удаляет указанный префикс при снятии пометки на удаление.

## 2.8.2

Рефакторинг:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - в обработчике бизнес-события регистрации входящего документа:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`.
      исправлена генерация в журнале регистрации.

## 2.7.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлен обработчик бизнес-события изменения внутреннего документа:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеУстановитьСостояниеПодписан`.
      Для документов, для которых ведётся учёт сторон, корректирует состояние
      по табличной части документа.
    - добавлен
      `ИТГ_РаботаСПодписямиДокументов.ЗаполнитьСостояниеПодписейВСторонахПоСостояниюДокумента`

## 2.6.2

Рефакторинг:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - в обработчике бизнес-события регистрации входящего документа,
      созданного на основании входящего письма,
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`
      проверяем функциональную опцию "ИспользованиеВстроеннойПочты".

## 2.6.1

Рефакторинг:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - в обработчике бизнес-события регистрации входящего документа,
      созданного на основании входящего письма,
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`
      в случае, если письмо основание - результат пересылки исходного письма,
      тогда ответ будет сформирован на исходное письмо.

## 2.6.0

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлен обработчик бизнес-события регистрации входящего документа,
      созданного на основании входящего письма:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеУдалитьПисьмоОснованиеОтСканера`.
      После регистрации входящего документа на основании письма от сканера
      удаляет письмо и связь с ним.

## 2.5.2

Рефакторинг:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - в обработчике бизнес-события регистрации входящего документа,
      созданного на основании входящего письма,
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`
      добавлено управление транзакциями.

## 2.5.1

Новые возможности:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлен обработчик бизнес-события регистрации входящего документа,
      созданного на основании входящего письма:
      `ИТГ_БизнесСобытия.ОбработатьСобытиеСообщитьОтправителюОРегистрацииВходящегоДокумента`

## 2.0.1

Новые возможности:

- в документации

  - первая редакция интеграции с ReadTheDocs

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - добавлена автоподстановка "Руководитель подразделения"
    - добавлена автоподстановка "Исполнители документа (активные)"
    - добавлен предикат `ИТГ_РаботаСУсловиямиМаршрутизации.ПроверитьРуководительПодразделенияВЧислеИсполнителей`

Изменения:

- в конфигурации

  - через расширение ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

    - роли "Руководитель подразделения" и "Делопроизводитель подразделения"
      требуют использования в качестве объекта адресации организации
      (если включена функциональная опция "Использовать учёт по организациям")
      и подразделения

## 1.4.0

Исправлены ошибки:

- в конфигурации

  - через расширение ДокументооборотКОРП_ИсправлениеПодбораШаблоновПроцессовДляДокумента:

    - обеспечен подбор и общих шаблонов процессов для документов

## 1.3.1

Рефакторинг:

- в расширении ДокументооборотКОРП_АдаптацияНастроекДоступностиПоСостоянию:

  - использована более подходящая функция
    `Делопроизводство.ПолучитьВидДокументаИРодителей(ВидДокумента)`

## 1.3.0

Новые возможности:

- в расширении ДокументооборотКОРП_ДополнительныеОбработчикиДляПроцессов:

  - добавлена автоподстановка "Делопроизводитель подразделения"

- в расширении ДокументооборотКОРП_АдаптацияНастроекДоступностиПоСостоянию:

  - обеспечена возможность указания для настроек доступности по состоянию
    групп видов документов
